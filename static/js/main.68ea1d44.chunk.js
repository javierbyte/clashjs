(this.webpackJsonpclashjs=this.webpackJsonpclashjs||[]).push([[0],[,,,,,function(t,n){var e=["north","east","south","west"],i=["north","east","south","west","shoot"],o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];switch(i){case e[0]:return t[1]===n[1]&&t[0]>n[0];case e[1]:return t[0]===n[0]&&t[1]<n[1];case e[2]:return t[1]===n[1]&&t[0]<n[0];case e[3]:return t[0]===n[0]&&t[1]>n[1]}};t.exports={randomMove:function(){return Math.random()>.33?"move":i[Math.floor(Math.random()*i.length)]},getDirection:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t=t||[],n=n||[];var e=Math.abs(t[0]-n[0]),i=Math.abs(t[1]-n[1]);return e>i?t[0]-n[0]>0?"north":"south":t[1]-n[1]>0?"west":"east"},isVisible:o,canKill:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return n.some((function(n){return n.isAlive&&o(t.position,n.position,t.direction)}))},safeRandomMove:function(){return Math.random()>.33?"move":e[Math.floor(Math.random()*e.length)]},fastGetDirection:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=Math.abs(t[0]-n[0]);return e?t[0]-n[0]>0?"north":"south":t[1]-n[1]>0?"west":"east"},turn:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,i=e.indexOf(t);return e[(i+n)%4]},getDistance:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=Math.abs(t[0]-n[0]),i=Math.abs(t[1]-n[1]);return i+e}}},,,,,,,,,,function(t,n){var e,i,o,a,r="0123456789",s="abcdefghijklmnoprstuvxuyz",c=s.toUpperCase(),l="+/";t.exports=n={},e=function(){return[r,s,c,l].join("")},i=function(){return[r,s,c].join("")},o=function(){return[c,r].join("")},a=function(t,n){var e,i="";for(e=0;e<n;e+=1)i+=t[Math.ceil(100*Math.random()%t.length||1)-1];return i},n.generateBase64String=function(t){return a(e(),t)},n.generateBase62String=function(t){return a(i(),t)},n.generateBase32String=function(t){return a(o(),t)},n.generateBase10String=function(t){return a(r,t)}},,function(t,n,e){t.exports={manuelmhtr:e(25),ericku:e(26),siegfried:e(27),horror:e(28),elperron:e(29),yuno:e(30),xmontoya:e(31),margeux:e(32)}},,,,,,,,function(t,n,e){var i=e(5),o={north:"vertical",east:"horizontal",south:"vertical",west:"horizontal"},a={info:{name:"Manuelmhtr",style:3},ai:function(t,n,e){var a=[],r={vulnerabilityLevel:null,canKill:null,nearestAmmo:null,nearestEnemy:null,canMove:null};function s(t){var n=0;if(a.forEach((function(e){i.isVisible(e.position,t,e.direction)&&e.ammo>0?n=Math.max(n,1):c(e.position,t)&&(e.ammo>0||1===e.nearestAmmoDistance)&&(n=Math.max(n,.5))})),0===n){var e=[t[0]+1,t[1]+1],o=[t[0]-1,t[1]-1];a.forEach((function(t){t.ammo>0&&(c(t.position,e)||c(t.position,o))&&(n=Math.max(n,.25))}))}return n}function c(t,n){var e=!1;return e=(e=(e=(e=e||t[1]===n[1]&&t[0]>n[0])||t[0]===n[0]&&t[1]<n[1])||t[1]===n[1]&&t[0]<n[0])||t[0]===n[0]&&t[1]>n[1]}function l(t,n){var e=Math.abs(t[0]-n.position[0]),i=Math.abs(t[1]-n.position[1]);return Math.min(i,e)}function u(){var n=t.direction,i=r.vulnerabilityLevel,o=0;return[{direction:"north",position:[t.position[0]-1,t.position[1]]},{direction:"east",position:[t.position[0],t.position[1]+1]},{direction:"south",position:[t.position[0]+1,t.position[1]]},{direction:"west",position:[t.position[0],t.position[1]-1]}].forEach((function(a){a.vulnerability=s(a.position),a.distanceLeft=function(n){if("north"===n)return t.position[0];if("east"===n)return e.gridSize-t.position[1];if("south"===n)return e.gridSize-t.position[0];if("west"===n)return t.position[1]}(a.direction),a.canMove=m(t.position,a.direction);var r=a.vulnerability<i||a.vulnerability===i&&a.distanceLeft>o;a.canMove&&r&&(n=a.direction,i=a.vulnerability,o=a.distanceLeft)})),n===t.direction?f():n}function m(t,n){return"north"===n?t[0]>0:"east"===n?t[1]<e.gridSize:"south"===n?t[0]<e.gridSize:"west"===n?t[1]>0:void 0}function d(n){if(i.isVisible(t.position,n.position,t.direction))return"shoot";var e=function(){var e=c(t.position,n.position),a=o[n.direction];return e?i.fastGetDirection(t.position,n.position):"vertical"===a?n.position[1]>t.position[1]?"east":"west":n.position[0]>t.position[0]?"south":"north"}(),a=l(t.position,n);return e===t.direction&&(a>1||0===n.ammo)?"move":e}function f(){var n;return"north"===t.direction?n=[t.position[0]-1,t.position[1]]:"east"===t.direction?n=[t.position[0],t.position[1]+1]:"south"===t.direction?n=[t.position[0]+1,t.position[1]]:"west"===t.direction&&(n=[t.position[0],t.position[1]-1]),1===s(n)?null:"move"}function h(n){var e=i.fastGetDirection(t.position,n);return e===t.direction?f():e}return n.forEach((function(t){!0===t.isAlive&&(t.nearestAmmoDistance=function(t){var n=null;return e.ammoPosition.forEach((function(e){var o=i.getDistance(t,e);(null===n||o<n)&&(n=o)})),n}(t.position),a.push(t))})),r.vulnerabilityLevel=s(t.position),r.canKill=t.ammo>0&&i.canKill(t,n),r.nearestAmmo=function(t){var n=null,o=null;return e.ammoPosition.forEach((function(e){var a=i.getDistance(t,e);(null===o||a<o)&&(n={position:e,distance:o=a})})),n}(t.position),r.nearestEnemy=function(t){var n=null,e=null;return a.forEach((function(i){var o=l(t,i);(null===e||o<e)&&(n={instance:i,distance:e=o})})),n}(t.position),r.canMove=m(t.position,t.direction),1===r.vulnerabilityLevel||r.vulnerabilityLevel>=.5&&!0!==r.canKill?function(){if(1===r.vulnerabilityLevel){var n,e=r.canMove;return a.forEach((function(e){e.ammo>0&&i.isVisible(e.position,t.position,e.direction)&&(n=e)})),n&&o[n.direction]===o[t.direction]&&(e=!1),e?"move":n&&t.ammo>0?d(n):u()}return u()}():!0===r.canKill?"shoot":0===t.ammo&&r.nearestAmmo?h(r.nearestAmmo.position):t.ammo>0&&r.nearestEnemy?r.nearestAmmo&&r.nearestAmmo.distance<r.nearestEnemy.distance?h(r.nearestAmmo.position):d(r.nearestEnemy.instance):u()}};t.exports=a},function(t,n,e){var i=e(5),o=["north","east","south","west"],a=function(t,n){var e,o=function(t,n){if(n.ammoPosition.length){var e=t.position,o=n.ammoPosition[0];return n.ammoPosition.forEach((function(t){i.getDistance(e,t)<i.getDistance(e,o)&&(o=t)})),o}}(t,n);if(o)return(e=i.fastGetDirection(t.position,o))!==t.direction?e:"move"},r=function(t,n,e,a){var r=JSON.parse(JSON.stringify(n));if("move"===t)switch(n.direction){case o[0]:r.position[0]>0&&r.position[0]--;break;case o[1]:r.position[1]<a.gridSize[1]&&r.position[1]++;break;case o[2]:r.position[0]<a.gridSize[0]&&r.position[0]++;break;case o[3]:r[1]>0&&r.position[1]--}return!function(t,n){return n.filter((function(t){return t.isAlive})).map((function(n){return i.canKill(n,[t],n.direction)})).filter((function(t){return!0===t})).length>0}(r,e)},s=function(t,n,e){var i=r("north",t,n,e),o=r("move",t,n,e);return i&&t.ammo?l(t,n)||c(t,n):o?"move":void 0},c=function(t,n){var e=function(t,n){var e,o=n.slice(0,n.length);return o=o.filter((function(t){return t.isAlive})),e=o[0],o.forEach((function(n){i.getDistance(t,n)<i.getDistance(t,e)&&(e=n)})),e}(t,n),o=i.fastGetDirection(t.position,e.position);return o!==t.direction?o:"move"},l=function(t,n){var e="north"===t.direction?"south":"north",a=JSON.parse(JSON.stringify(t));return n=n.filter((function(t){return t.isAlive})),o.forEach((function(t){a.direction=t,i.canKill(a,n)&&(e=t)})),e},u={info:{name:"Cristine",style:{type:"cristine.svg",hue:0}},ai:function(t,n,e){return t.ammo?function(t,n,e){var o;return i.canKill(t,n)?"shoot":(o=l(t,n))&&r(o,t,n,e)?o:s(t,n,e)||"stay"}(t,n,e):Math.random()>.8?"move":function(t,n,e){var o;return(o=a(t,e))&&r(o,t,n,e)?o:s(t,n,e)||i.safeRandomMove()}(t,n,e)}};t.exports=u},function(t,n,e){var i=e(5),o={info:{name:"Siegfried",style:4},ai:function(t,n,e){var o;return i.canKill(t,n)&&t.ammo?"shoot":e.ammoPosition.length?(o=i.getDirection(t.position,e.ammoPosition[0]))!==t.direction?o:"move":i.randomMove()}};t.exports=o},function(t,n,e){var i=e(5),o={info:{name:"Horror",style:10},ai:function(t,n,e){var o;return i.canKill(t,n)&&t.ammo?"shoot":e.ammoPosition.length?(o=i.fastGetDirection(t.position,e.ammoPosition[0]))!==t.direction?o:"move":i.safeRandomMove()}};t.exports=o},function(t,n,e){var i=e(5),o=0,a=null,r={1:"north",2:"east",3:"south",4:"west"},s=0,c={info:{name:"ElPerron",style:7},ai:function(t,n,e){var c,l;if(i.canKill(t,n)&&t.ammo)return"shoot";if(0==t.ammo||1==s){var u=function(){var n=t.position,i=22,o=null;for(var a in e.ammoPosition){var r=e.ammoPosition[a],s=Math.abs(n[1]-r[1])+Math.abs(n[0]-r[0]);s<i&&(i=s,o=r)}return o}();return c=i.getDirection(t.position,u),null!=(l=a)&&l[0]==t.position[0]&&l[1]==t.position[1]&&(s=0),a=u,c!==t.direction?c:"move"}return++o>4&&(o=1,s++),r[o]}};t.exports=c},function(t,n,e){var i=e(5),o=["north","east","south","west"],a=function(t,n){var e=n.reduce((function(n,e){return(-1===n[0]||i.getDistance(t,e)<n[0])&&(n[0]=i.getDistance(t,e),n[1]=e),n}),[-1,0]);return i.fastGetDirection(t,e[1])},r={info:{name:"Yuno",style:9},ai:function(t,n,e){var r,s,c,l;return i.canKill(t,n)&&t.ammo?"shoot":t.ammo?(c=t.position,l=n.map((function(t){return t.position})),(s=o.reduce((function(t,n){return t||l.reduce((function(t,e){return t||(i.isVisible(c,e,n)?n:null)}),null)}),null))||(s=a(t.position,n.map((function(t){return t.position}))))!==t.direction?s:"move"):e.ammoPosition.length?(r=a(t.position,e.ammoPosition))!==t.direction?r:"move":i.safeRandomMove()}};t.exports=r},function(t,n,e){var i=e(5),o={info:{name:"Xmontoya89",style:1},ai:function(t,n,e){var o;return i.canKill(t,n)&&t.ammo?"shoot":e.ammoPosition.length?(o=i.fastGetDirection(t.position,e.ammoPosition[0]))!==t.direction?o:i.safeRandomMove():"move"}};t.exports=o},function(t,n,e){var i=e(5),o=!0,a={info:{name:"margeux",style:5},ai:function(t,n,e){var a,r;return t.ammo>0&&(o=!1),0==t.ammo&&(o=!0),e.ammoPosition.length&&o?(a=i.fastGetDirection(t.position,e.ammoPosition[0]))!==t.direction?a:"move":o?i.canKill(t,n)&&t.ammo?"shoot":e.ammoPosition.length?(a=i.fastGetDirection(t.position,e.ammoPosition[0]))!==t.direction?a:"move":i.safeRandomMove():(r=i.fastGetDirection(t.position,n[0].position))!==t.direction?i.fastGetDirection(n[0].position,t.position)!==n[0].position?r:i.safeRandomMove():i.canKill(t,n)&&t.ammo?"shoot":i.safeRandomMove()}};t.exports=a},function(t,n,e){"use strict";e.r(n);var i=e(2),o=e.n(i),a=e(14),r=e.n(a),s=e(13),c=e(3),l=e(4),u=e(7),m=e(6),d=e(1),f=e.n(d),h=e(0),v=function(t){Object(u.a)(e,t);var n=Object(m.a)(e);function e(){return Object(c.a)(this,e),n.apply(this,arguments)}return Object(l.a)(e,[{key:"render",value:function(){var t,n=this.props.gridSize,e=100/n,i=[];for(t=0;t<n*n;t++)i.push(Object(h.jsx)("div",{style:{height:e+"vmin",width:e+"vmin"},className:"clash-tile"},t));return Object(h.jsx)("div",{children:i})}}]),e}(o.a.Component),p=function(t){Object(u.a)(e,t);var n=Object(m.a)(e);function e(){return Object(c.a)(this,e),n.apply(this,arguments)}return Object(l.a)(e,[{key:"render",value:function(){var t=this.props,n=t.gridSize,e=t.ammoPosition,i=100/n,o=f.a.map(e,(function(t,n){return Object(h.jsx)("div",{className:"clash-ammo",style:{top:i*t[0]+"vmin",left:i*t[1]+"vmin",width:i+"vmin",height:i+"vmin"}},n)}));return Object(h.jsx)("div",{style:{zIndex:1},className:"clash-layer animation-glow",children:o})}}]),e}(o.a.Component);var g=function(t){var n=t.gridSize,e=t.playerStates,i=t.playerInstances,o=t.speed,a=e.map((function(t){return t.directionAngle})),r=100/n,s=f.a.map(e,(function(t,n){var e,s=t.id,c=i.find((function(t){return t.id===s})).info;return Object(h.jsxs)("div",{className:"clash-player-container",style:{transition:"transform ".concat(2*o+16,"ms"),width:r+"vmin",height:r+"vmin",opacity:t.isAlive?1:.5,zIndex:t.isAlive?2:0,transform:"translateY(".concat(r*t.position[0],"vmin) translateX(").concat(r*t.position[1],"vmin) scale(").concat(t.isAlive?1:.66,")")},children:[Object(h.jsx)("div",{className:"clash-player -name-".concat(t.name),style:{transition:"transform ".concat(2*o+16,"ms"),width:1.25*r+"vmin",height:1.25*r+"vmin",left:-.125*r+"vmin",top:-.125*r+"vmin",filter:"grayscale(".concat(t.isAlive?"0%":"100%",") hue-rotate(").concat(t.style.hue||0,"deg)"),backgroundImage:(e=t.style,f.a.isPlainObject(e)?"url(static/rockets/".concat(e.type,")"):"url(static/rockets/rocket".concat(e,".png)")),transform:"rotate(".concat(90*a[n]+(t.isAlive?0:45),"deg)")}}),Object(h.jsxs)("div",{className:"clash-player-name",style:{textDecoration:t.isAlive?"none":"line-through"},children:[c.name,new Array(Math.min(t.ammo,3)).fill("\ud83d\ude80").join("")]})]},s)}));return Object(h.jsx)("div",{className:"clash-layer",children:s})},y=e(8),j=e(10);var b=function(t){var n=o.a.useState(!1),e=Object(j.a)(n,2),i=e[0],a=e[1],r=window.innerHeight<1080,s=i||!r,c=t.gameStats,l=t.rounds,u=t.total,m=Object.keys(c).map((function(t){return Object(y.a)(Object(y.a)({},c[t]),{},{id:t})})).sort((function(t,n){return n.score-t.score}));return Object(h.jsxs)("div",{className:"stats ".concat(r?"-clickable":""),onClick:function(){a(!i)},children:[s?Object(h.jsxs)("div",{style:{textAlign:"center",padding:"0.25rem 0 0.5rem",color:"#2ecc71"},children:["Round ",l," of ",u]}):Object(h.jsx)("div",{style:{textAlign:"center",padding:"0.25rem 0 0.5rem"},children:"Click to see stats"}),s&&Object(h.jsxs)("table",{children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Player"}),Object(h.jsx)("th",{style:{padding:0}}),Object(h.jsx)("th",{alt:"Eliminations",style:{textAlign:"right"},children:"E"}),Object(h.jsx)("th",{alt:"Wins",style:{textAlign:"right"},children:"W"}),Object(h.jsx)("th",{alt:"Score",style:{textAlign:"right"},children:"S"})]})}),Object(h.jsx)("tbody",{children:f.a.map(m,(function(t,n){return Object(h.jsxs)("tr",{className:"player-stats ".concat(t.isAlive?"":"-dead"),children:[Object(h.jsx)("td",{className:"player-name",children:t.name}),Object(h.jsx)("td",{style:{padding:0},className:"player-dead-emoji",children:Object(h.jsx)("span",{role:"img","aria-label":"dead",children:"\ud83d\udc80"})}),Object(h.jsx)("td",{className:"stats-results",children:t.kills}),Object(h.jsx)("td",{className:"stats-results",children:t.wins}),Object(h.jsx)("td",{className:"stats-results",children:t.score})]},n)}))})]})]})},x=["north","east","south","west"],O=function(t){Object(u.a)(e,t);var n=Object(m.a)(e);function e(){return Object(c.a)(this,e),n.apply(this,arguments)}return Object(l.a)(e,[{key:"render",value:function(){var t=this.props,n=t.shoots,e=100/t.gridSize,i=f.a.map(n,(function(t,n){return Object(h.jsx)("div",{className:"clash-shoot animation-shot",style:{top:e*t.origin[0]+"vmin",left:e*t.origin[1]+"vmin",transform:"translatex("+e/2+"vmin) translatey("+e/2+"vmin) rotate("+90*(x.indexOf(t.direction)-1)+"deg) "}},n)}));return Object(h.jsx)("div",{className:"clash-layer",children:i})}}]),e}(o.a.Component);function S(t,n){var e=Object(i.useRef)();Object(i.useEffect)((function(){e.current=t})),Object(i.useEffect)((function(){var t=setInterval((function(){e.current()}),n);return function(){return clearInterval(t)}}),[n])}function w(t){var n=o.a.useState(!1),e=Object(j.a)(n,2),i=e[0],a=e[1],r=t.hide;return S((function(){a(!0)}),16),Object(h.jsx)("div",{className:"notifications-element ".concat(t.id%2===0?"-alt":""," ").concat(i&&!r?"":"-hide"),children:Object(h.jsx)("div",{className:"notifications-element-text",children:t.text})})}var A=function(t){var n=o.a.useState((new Date).getTime()),e=Object(j.a)(n,2),i=e[0],a=e[1],r=t.notifications.filter((function(t){return t&&t.text})).filter((function(t){return i<t.expire})).sort((function(t,n){return t.date-n.date})).slice(-7);return S((function(){a((new Date).getTime())}),50),Object(h.jsx)("div",{className:"notifications",children:r.map((function(t,n){var e=n<=r.length-7,o=i<t.expire-500;return Object(h.jsx)(w,Object(y.a)({hide:e||!o},t),t.id)}))})},M=e(15),k=e.n(M),D=function(){function t(n){Object(c.a)(this,t),this.id=k.a.generateBase32String(8),this.info=n.info,this.name=n.info.name,this.ai=n.ai}return Object(l.a)(t,[{key:"execute",value:function(t,n,e){try{return this.ai(t,n,e)}catch(i){console.error("!",i)}}}]),t}(),E=e(1),P=e(5),N=["north","east","south","west"],I=function(t,n){return t<0?0:t>n-1?n-1:t},z=function(t){var n=t.playerIndex,e=t.playerAction,i=t.playerStates,o=t.playerInstances,a=t.gameEnvironment,r=t.evtCallback,s=t.coreCallback,c=i[n];if(-1!==N.indexOf(e)){var l=(N.indexOf(e)+4)%4-(N.indexOf(c.direction)+4)%4;return 3===l&&(l=-1),-3===l&&(l=1),i[n].direction=e,i[n].directionAngle=i[n].directionAngle+l,i}if("move"===e){switch(c.direction){case N[0]:c.position[0]--;break;case N[1]:c.position[1]++;break;case N[2]:c.position[0]++;break;case N[3]:c.position[1]--}c.position[0]=I(c.position[0],a.gridSize),c.position[1]=I(c.position[1],a.gridSize),a.ammoPosition.forEach((function(t,n){t[0]===c.position[0]&&t[1]===c.position[1]&&(a.ammoPosition.splice(n,1),c.ammo+=1)}))}if("shoot"===e&&c.ammo>0){c.ammo-=1;var u=[],m=[];r("SHOOT",{shooter:n,origin:c.position,direction:c.direction}),i.forEach((function(t,n){t.isAlive&&P.isVisible(c.position,t.position,c.direction)&&(u.push(n),t.isAlive=!1)})),u.length&&(m=E.filter(i,(function(t){return t.isAlive})),s("KILL",{killer:o[n],killed:E.map(u,(function(t){return o[t]}))}),r("KILL",{killer:o[n],killed:E.map(u,(function(t){return o[t]}))}),1===m.length&&(s("WIN",{winner:o[n]}),r("WIN",{winner:o[n]})))}return i},C=e(16),R=e.n(C),G=["north","east","south","west"],K=window.innerWidth>720?13:11,L=new R.a,W={running:!1,currentPlayer:0,gameEnvironment:{gridSize:K,ammoPosition:[]},suddenDeathCount:0,totalRounds:10,rounds:0,playerInstances:[],playerStates:[],playerDefinition:{},gameStats:{}};var J=function(t){function n(t,n){console.info("ClashCore: Emit",{name:t,payload:n}),L.emit("CLASHJS",{name:t,payload:n})}function e(t,e){n(t,e)}function i(t,e){if("KILL"===t){var i=e.killer,o=e.killed;W.gameStats[i.id].kills+=o.length,f.a.forEach(W.playerInstances,(function(t){var n=W.gameStats[t.id];o.indexOf(t)>-1&&(W.alivePlayerCount--,n.deaths++),n.deaths?n.kdr=n.kills/n.deaths:n.kdr=n.kills})),W.suddenDeathCount=0}("WIN"===t&&(W.gameStats[e.winner.id].wins++,W.suddenDeathCount=0,W.rounds>=W.totalRounds)||"DRAW"===t&&(W.suddenDeathCount=0,W.rounds>=W.totalRounds))&&n("GAME_OVER")}function o(){var t=[Math.floor(Math.random()*W.gameEnvironment.gridSize),Math.floor(Math.random()*W.gameEnvironment.gridSize)];W.gameEnvironment.ammoPosition.some((function(n){return n[0]===t[0]&&n[1]===t[1]}))?o():W.gameEnvironment.ammoPosition.push(t)}return W.playerInstances=t.map((function(t){var n=new D(t);return W.gameStats[n.id]={id:n.id,name:n.name,kills:0,wins:0},n})),{newGame:function(){W.gameEnvironment={gridSize:K,ammoPosition:[]},W.rounds=W.rounds+1,W.suddenDeathCount=0,W.playerInstances=f.a.shuffle(f.a.cloneDeep(W.playerInstances)),W.playerStates=W.playerInstances.map((function(t){var n=W.gameEnvironment.gridSize,e=Math.floor(4*Math.random());return{name:t.name,id:t.id,style:t.info.style,position:[Math.floor(Math.random()*n),Math.floor(Math.random()*n)],direction:G[e],directionAngle:e,ammo:0,isAlive:!0}})),W.currentPlayer=0,W=Object(y.a)({},W),o()},getAlivePlayerCount:function(){return W.playerStates.filter((function(t){return t.isAlive})).length},getState:function(){var t=W.gameStats,n=function(n){var e=t[n];e.score=5*e.wins+e.kills,e.isAlive=W.playerStates.find((function(t){return t.id===n})).isAlive};for(var e in t)n(e);return JSON.parse(JSON.stringify({gameEnvironment:W.gameEnvironment,gameStats:t,rounds:W.rounds,totalRounds:W.totalRounds,playerStates:W.playerStates,playerInstances:W.playerInstances}))},nextPly:function(){var t=f.a.cloneDeep(W.playerStates);if(W.suddenDeathCount++,175===W.suddenDeathCount&&n("PRE_DRAW"),!(W.suddenDeathCount>210&&(n("DRAW"),W.rounds>=W.totalRounds))){var a,r,s=t.filter((function(t,n){return n!==W.currentPlayer&&t.isAlive}));return W.playerStates[W.currentPlayer].isAlive&&(a=W.currentPlayer,r=W.playerInstances[W.currentPlayer].execute(t[W.currentPlayer],s,f.a.cloneDeep(W.gameEnvironment)),W.playerStates=z({playerIndex:a,playerAction:r,playerStates:W.playerStates,playerInstances:W.playerInstances,gameEnvironment:W.gameEnvironment,evtCallback:e,coreCallback:i})),W.currentPlayer=(W.currentPlayer+1)%W.playerInstances.length,W.gameEnvironment.ammoPosition.length<W.playerStates.length/1.3&&Math.random()>.93&&o(),Math.random()>.98&&o(),this.getState()}n("GAME_OVER")},addListener:function(t){L.addListener("CLASHJS",t)}}},T=e(17),V=e.n(T),B=f.a.shuffle(f.a.map(V.a,(function(t){return t}))),H=document.location.search.includes("debug"),_=H?32:200,X=H?32:100,Y=J(B);Y.newGame();var U=function(t){Object(u.a)(e,t);var n=Object(m.a)(e);function e(t){var i;return Object(c.a)(this,e),(i=n.call(this,t)).state={clashState:null,shoots:[],speed:_,notifications:[],finished:!1},i}return Object(l.a)(e,[{key:"componentWillMount",value:function(){var t=this;Y.addListener((function(n){var e=n.name,i=n.payload;if("SHOOT"!==e){if("KILL"===e)return t.handleKill(i);if("WIN"===e){var o=f.a.get(i,["winner","info","name"]);return o&&t.pushNotification({text:Object(h.jsxs)("div",{style:{color:"#2ecc71"},children:[Object(h.jsx)("strong",{children:o})," won this one!"]})}),void t.newGame()}return"DRAW"===e?(t.pushNotification({text:Object(h.jsx)("strong",{style:{color:"#f39c12"},children:"We got a draw!"})}),void t.newGame()):("PRE_DRAW"===e&&t.pushNotification({text:"They are too strong!"}),"GAME_OVER"===e?t.endGame():void 0)}t.setState((function(t){return{shoots:[].concat(Object(s.a)(t.shoots),[{direction:i.direction,origin:i.origin.slice(),time:(new Date).getTime()}])}}))})),this.nextTurn()}},{key:"newGame",value:function(){Y.getState().rounds>=Y.getState().totalRounds||(this.pushNotification({text:"Starting a new game!"}),this.setState({speed:_},(function(){Y.newGame()})))}},{key:"nextTurn",value:function(){var t=this,n=this.state,e=n.speed;n.finished||this.setState({clashState:Y.nextPly(),speed:this.state.speed>X?parseInt(.98*this.state.speed,10):X},(function(){Y.getAlivePlayerCount()>=2&&window.setTimeout((function(){t.nextTurn()}),e)}))}},{key:"handleKill",value:function(t){var n=t.killer,e=t.killed;this.pushNotification({text:"".concat(n.name," eliminated ").concat(f.a.map(e,(function(t){return t.name})).join(","))})}},{key:"endGame",value:function(){var t=Y.getState(),n=f.a.sortBy(t.gameStats,(function(t){return-1*t.score+-.1*t.wins}))[0];this.pushNotification({expire:1/0,text:Object(h.jsxs)("b",{style:{color:"#2ecc71",fontWeight:600},children:["Congratulations ",n.name,"!"]})}),this.pushNotification({expire:1/0,text:Object(h.jsx)("div",{children:Object(h.jsx)("button",{style:{border:"none",height:"2rem",padding:"0 1rem",fontSize:"14px",borderRadius:"4"},onClick:function(){window.location.reload()},children:"Start Again"})})}),this.setState({shoots:[],finished:!0})}},{key:"pushNotification",value:function(t){var n=t.text,e=t.expire;this.setState((function(t){return{notifications:[].concat(Object(s.a)(t.notifications),[{expire:e||(new Date).getTime()+7e3,date:(new Date).getTime(),text:n,id:t.notifications.length}])}}))}},{key:"render",value:function(){if(!this.state)return null;var t=this.state,n=t.shoots,e=t.speed,i=t.notifications,o=Y.getState(),a=o.gameStats,r=o.playerStates,s=o.playerInstances,c=o.rounds,l=o.totalRounds,u=o.gameEnvironment;return Object(h.jsxs)("div",{className:"clash",children:[Object(h.jsx)(v,{gridSize:u.gridSize}),Object(h.jsx)(O,{shoots:n.slice(),gridSize:u.gridSize}),Object(h.jsx)(p,{gridSize:u.gridSize,ammoPosition:u.ammoPosition}),Object(h.jsx)(g,{speed:e,gridSize:u.gridSize,playerInstances:s,playerStates:r}),Object(h.jsx)(A,{notifications:i}),Object(h.jsx)(b,{rounds:c,total:l,gameStats:a}),H&&Object(h.jsxs)("pre",{className:"debugger",children:[Object(h.jsx)("b",{children:"playerInstances"}),JSON.stringify(s,0,2),Object(h.jsx)("hr",{}),Object(h.jsx)("b",{children:"playerStates"}),JSON.stringify(r,0,2)]})]})}}]),e}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(Object(h.jsx)(U,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}],[[33,1,2]]]);
//# sourceMappingURL=main.68ea1d44.chunk.js.map